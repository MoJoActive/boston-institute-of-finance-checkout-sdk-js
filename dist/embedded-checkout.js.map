{"version":3,"file":"embedded-checkout.js","mappings":"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","sources":["webpack://@bigcommerce/checkout-sdk/external commonjs \"iframe-resizer\"","webpack://@bigcommerce/checkout-sdk/external commonjs \"iframe-resizer/js/iframeResizer.contentWindow\"","webpack://@bigcommerce/checkout-sdk/webpack/bootstrap","webpack://@bigcommerce/checkout-sdk/webpack/runtime/compat get default export","webpack://@bigcommerce/checkout-sdk/webpack/runtime/define property getters","webpack://@bigcommerce/checkout-sdk/webpack/runtime/hasOwnProperty shorthand","webpack://@bigcommerce/checkout-sdk/webpack/runtime/make namespace object","webpack://@bigcommerce/checkout-sdk/external commonjs \"@bigcommerce/request-sender\"","webpack://@bigcommerce/checkout-sdk/external commonjs \"tslib\"","webpack://@bigcommerce/checkout-sdk/./packages/ui/src/loading-indicator/loading-indicator.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/standard-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/utility/set-prototype-of.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/invalid-argument-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/url/parse-url.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/utility/bind-decorator.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/is-iframe-event.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/iframe-event-listener.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/url/append-www.ts","webpack://@bigcommerce/checkout-sdk/external commonjs \"rxjs\"","webpack://@bigcommerce/checkout-sdk/external commonjs \"rxjs/operators\"","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/iframe-event-poster.ts","webpack://@bigcommerce/checkout-sdk/external commonjs \"local-storage-fallback\"","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/storage/browser-storage.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/embedded-checkout-events.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/request-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/errors/invalid-login-token-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/errors/not-embeddable-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/embedded-content-events.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/embedded-checkout.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/resizable-iframe-creator.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/iframe-resizer.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/embed-checkout.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/handle-frame-loaded-event.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/custom-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/iframe-embedded-checkout-messenger.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/noop-embedded-checkout-messenger.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/create-embedded-checkout-messenger.ts"],"sourcesContent":["module.exports = require(\"iframe-resizer\");","module.exports = require(\"iframe-resizer/js/iframeResizer.contentWindow\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@bigcommerce/request-sender\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"tslib\");","import { LoadingIndicatorStyles } from './loading-indicator-styles';\r\n\r\nconst DEFAULT_STYLES: LoadingIndicatorStyles = {\r\n    size: 70,\r\n    color: '#d9d9d9',\r\n    backgroundColor: '#ffffff',\r\n};\r\n\r\nconst ROTATION_ANIMATION = 'embedded-checkout-loading-indicator-rotation';\r\n\r\nexport default class LoadingIndicator {\r\n    private container: HTMLElement;\r\n    private indicator: HTMLElement;\r\n    private styles: LoadingIndicatorStyles;\r\n\r\n    constructor(options?: { styles?: LoadingIndicatorStyles }) {\r\n        this.styles = { ...DEFAULT_STYLES, ...(options && options.styles) };\r\n\r\n        this.defineAnimation();\r\n\r\n        this.container = this.buildContainer();\r\n        this.indicator = this.buildIndicator();\r\n\r\n        this.container.appendChild(this.indicator);\r\n    }\r\n\r\n    show(parentId?: string): void {\r\n        if (parentId) {\r\n            const parent = document.getElementById(parentId);\r\n\r\n            if (!parent) {\r\n                throw new Error(\r\n                    'Unable to attach the loading indicator because the parent ID is not valid.',\r\n                );\r\n            }\r\n\r\n            parent.appendChild(this.container);\r\n        }\r\n\r\n        this.container.style.visibility = 'visible';\r\n        this.container.style.opacity = '1';\r\n    }\r\n\r\n    hide(): void {\r\n        const handleTransitionEnd = () => {\r\n            this.container.style.visibility = 'hidden';\r\n\r\n            this.container.removeEventListener('transitionend', handleTransitionEnd);\r\n        };\r\n\r\n        this.container.addEventListener('transitionend', handleTransitionEnd);\r\n\r\n        this.container.style.opacity = '0';\r\n    }\r\n\r\n    private buildContainer(): HTMLElement {\r\n        const container = document.createElement('div');\r\n\r\n        container.style.display = 'block';\r\n        container.style.bottom = '0';\r\n        container.style.left = '0';\r\n        container.style.height = '100%';\r\n        container.style.width = '100%';\r\n        container.style.position = 'absolute';\r\n        container.style.right = '0';\r\n        container.style.top = '0';\r\n        container.style.transition = 'all 250ms ease-out';\r\n        container.style.opacity = '0';\r\n\r\n        return container;\r\n    }\r\n\r\n    private buildIndicator(): HTMLElement {\r\n        const indicator = document.createElement('div');\r\n\r\n        indicator.style.display = 'block';\r\n        indicator.style.width = `${this.styles.size}px`;\r\n        indicator.style.height = `${this.styles.size}px`;\r\n        indicator.style.borderRadius = `${this.styles.size}px`;\r\n        indicator.style.border = 'solid 1px';\r\n        indicator.style.borderColor = `${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`;\r\n        indicator.style.margin = '0 auto';\r\n        indicator.style.position = 'absolute';\r\n        indicator.style.left = '0';\r\n        indicator.style.right = '0';\r\n        indicator.style.top = '50%';\r\n        indicator.style.transform = 'translateY(-50%) rotate(0deg)';\r\n        indicator.style.transformStyle = 'preserve-3d';\r\n        indicator.style.animation = `${ROTATION_ANIMATION} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`;\r\n\r\n        return indicator;\r\n    }\r\n\r\n    private defineAnimation(): void {\r\n        // In order to define CSS animation, we need to insert a stylesheet into the host frame.\r\n        // We only have to do it once.\r\n        if (document.getElementById(ROTATION_ANIMATION)) {\r\n            return;\r\n        }\r\n\r\n        const style = document.createElement('style');\r\n\r\n        style.id = ROTATION_ANIMATION;\r\n\r\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\r\n        document.head?.appendChild(style);\r\n\r\n        if (style.sheet instanceof CSSStyleSheet) {\r\n            // We need to provide the 2nd parameter for IE11, even though it is\r\n            // 0 by default for all other browsers.\r\n            style.sheet.insertRule(\r\n                `\r\n                @keyframes ${ROTATION_ANIMATION} {\r\n                    0% { transform: translateY(-50%) rotate(0deg); }\r\n                    100% { transform: translateY(-50%) rotate(360deg); }\r\n                }\r\n            `,\r\n                0,\r\n            );\r\n        }\r\n    }\r\n}\r\n","import { setPrototypeOf } from '../../utility';\r\n\r\nimport CustomError from './custom-error';\r\n\r\n/**\r\n * This error type should not be constructed directly. It is a base class for\r\n * all custom errors thrown in this library.\r\n */\r\nexport default abstract class StandardError extends Error implements CustomError {\r\n    name = 'StandardError';\r\n    type = 'standard';\r\n\r\n    constructor(message?: string) {\r\n        super(message || 'An unexpected error has occurred.');\r\n\r\n        setPrototypeOf(this, new.target.prototype);\r\n\r\n        if (typeof Error.captureStackTrace === 'function') {\r\n            Error.captureStackTrace(this, new.target);\r\n        } else {\r\n            this.stack = new Error(this.message).stack;\r\n        }\r\n    }\r\n}\r\n","export default function setPrototypeOf(object: any, prototype: object) {\r\n    if (Object.setPrototypeOf) {\r\n        Object.setPrototypeOf(object, prototype);\r\n    } else {\r\n        object.__proto__ = prototype;\r\n    }\r\n\r\n    return object;\r\n}\r\n","import StandardError from './standard-error';\r\n\r\n/**\r\n * This error should be thrown when a method is unable to proceed because the\r\n * caller has not provided all the arguments according to their requirements,\r\n * i.e.: if an argument is missing or it is not the expected data type.\r\n */\r\nexport default class InvalidArgumentError extends StandardError {\r\n    constructor(message?: string) {\r\n        super(message || 'Invalid arguments have been provided.');\r\n\r\n        this.name = 'InvalidArgumentError';\r\n        this.type = 'invalid_argument';\r\n    }\r\n}\r\n","import { InvalidArgumentError } from '../error/errors';\r\n\r\nimport Url from './url';\r\n\r\nexport default function parseUrl(url: string): Url {\r\n    if (!/^(https?:)?\\/\\//.test(url)) {\r\n        throw new InvalidArgumentError('The provided URL must be absolute.');\r\n    }\r\n\r\n    // new URL() is not supported in IE11, use anchor tag instead\r\n    const anchor = document.createElement('a');\r\n\r\n    anchor.href = url;\r\n\r\n    // IE11 returns 80 or 443 for the port number depending on the URL scheme,\r\n    // even if the port number is not specified in the URL.\r\n    const port =\r\n        anchor.port && url.indexOf(`${anchor.hostname}:${anchor.port}`) !== -1 ? anchor.port : '';\r\n\r\n    return {\r\n        hash: anchor.hash,\r\n        hostname: anchor.hostname,\r\n        href: anchor.href,\r\n        origin: `${anchor.protocol}//${anchor.hostname}${port ? `:${port}` : ''}`,\r\n        pathname: anchor.pathname,\r\n        port,\r\n        protocol: anchor.protocol,\r\n        search: anchor.search,\r\n    };\r\n}\r\n","/**\r\n * Decorates a class or a method by binding all its prototype methods or itself\r\n * to the calling instance respectively.\r\n */\r\nfunction bindDecorator<T extends Method>(\r\n    target: object,\r\n    key: string,\r\n    descriptor: TypedPropertyDescriptor<T>,\r\n): TypedPropertyDescriptor<T>;\r\nfunction bindDecorator<T extends Constructor<object>>(target: T): T;\r\n\r\nfunction bindDecorator(target: any, key?: any, descriptor?: any): any {\r\n    if (!key || !descriptor) {\r\n        return bindClassDecorator(target);\r\n    }\r\n\r\n    return bindMethodDecorator(target, key, descriptor);\r\n}\r\n\r\nexport default bindDecorator;\r\n\r\n/**\r\n * Decorates a class by binding all its prototype methods to the calling\r\n * instance.\r\n */\r\nexport function bindClassDecorator<T extends Constructor<object>>(target: T): T {\r\n    const decoratedTarget = class extends target {};\r\n\r\n    Object.getOwnPropertyNames(target.prototype).forEach((key) => {\r\n        const descriptor = Object.getOwnPropertyDescriptor(target.prototype, key);\r\n\r\n        if (!descriptor || key === 'constructor') {\r\n            return;\r\n        }\r\n\r\n        Object.defineProperty(\r\n            decoratedTarget.prototype,\r\n            key,\r\n            bindMethodDecorator(target.prototype, key, descriptor),\r\n        );\r\n    });\r\n\r\n    return decoratedTarget;\r\n}\r\n\r\n/**\r\n * Decorates a method by binding it to the calling instance.\r\n */\r\nexport function bindMethodDecorator<T extends Method>(\r\n    _: object,\r\n    key: string,\r\n    descriptor: TypedPropertyDescriptor<T>,\r\n): TypedPropertyDescriptor<T> {\r\n    if (typeof descriptor.value !== 'function') {\r\n        return descriptor;\r\n    }\r\n\r\n    let method: T = descriptor.value;\r\n\r\n    return {\r\n        get() {\r\n            const boundMethod = method.bind(this) as T;\r\n\r\n            Object.defineProperty(this, key, {\r\n                ...descriptor,\r\n                value: boundMethod,\r\n            });\r\n\r\n            return boundMethod;\r\n        },\r\n        set(value) {\r\n            method = value;\r\n        },\r\n    };\r\n}\r\n\r\nexport type Constructor<T> = new (...args: any[]) => T;\r\nexport type Method = (...args: any[]) => any;\r\n","import IframeEvent from './iframe-event';\r\n\r\nexport default function isIframeEvent<TEvent extends IframeEvent<TType>, TType extends string>(\r\n    object: any,\r\n    type: TType,\r\n): object is TEvent {\r\n    return object.type === type;\r\n}\r\n","import { appendWww, parseUrl } from '../url';\r\nimport { bindDecorator as bind } from '../utility';\r\n\r\nimport { IframeEventMap } from './iframe-event';\r\nimport isIframeEvent from './is-iframe-event';\r\n\r\nexport default class IframeEventListener<TEventMap extends IframeEventMap<keyof TEventMap>> {\r\n    private _isListening: boolean;\r\n    private _listeners: EventListeners<TEventMap>;\r\n    private _sourceOrigins: string[];\r\n\r\n    constructor(sourceOrigin: string) {\r\n        this._sourceOrigins = [\r\n            parseUrl(sourceOrigin).origin,\r\n            appendWww(parseUrl(sourceOrigin)).origin,\r\n        ];\r\n        this._isListening = false;\r\n        this._listeners = {};\r\n    }\r\n\r\n    listen(): void {\r\n        if (this._isListening) {\r\n            return;\r\n        }\r\n\r\n        this._isListening = true;\r\n\r\n        window.addEventListener('message', this._handleMessage);\r\n    }\r\n\r\n    stopListen(): void {\r\n        if (!this._isListening) {\r\n            return;\r\n        }\r\n\r\n        this._isListening = false;\r\n\r\n        window.removeEventListener('message', this._handleMessage);\r\n    }\r\n\r\n    addListener<TType extends keyof TEventMap>(\r\n        type: TType,\r\n        listener: (event: TEventMap[TType]) => void,\r\n    ): void {\r\n        let listeners = this._listeners[type];\r\n\r\n        if (!listeners) {\r\n            this._listeners[type] = listeners = [];\r\n        }\r\n\r\n        if (listeners.indexOf(listener) === -1) {\r\n            listeners.push(listener);\r\n        }\r\n    }\r\n\r\n    removeListener<TType extends keyof TEventMap>(\r\n        type: TType,\r\n        listener: (event: TEventMap[TType]) => void,\r\n    ): void {\r\n        const listeners = this._listeners[type];\r\n\r\n        if (!listeners) {\r\n            return;\r\n        }\r\n\r\n        const index = listeners.indexOf(listener);\r\n\r\n        if (index >= 0) {\r\n            listeners.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    trigger<TType extends keyof TEventMap>(event: TEventMap[TType]): void {\r\n        const listeners = this._listeners[event.type];\r\n\r\n        if (!listeners) {\r\n            return;\r\n        }\r\n\r\n        listeners.forEach((listener) => listener(event));\r\n    }\r\n\r\n    @bind\r\n    private _handleMessage(event: MessageEvent): void {\r\n        if (\r\n            this._sourceOrigins.indexOf(event.origin) === -1 ||\r\n            !isIframeEvent(event.data as TEventMap[keyof TEventMap], event.data.type)\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        this.trigger(event.data);\r\n    }\r\n}\r\n\r\ntype EventListeners<TEventMap> = {\r\n    [key in keyof TEventMap]?: Array<(event: TEventMap[key]) => void>;\r\n};\r\n","import parseUrl from './parse-url';\r\nimport Url from './url';\r\n\r\nexport default function appendWww(url: Url): Url {\r\n    return parseUrl(\r\n        url.hostname.indexOf('www') === 0\r\n            ? url.href\r\n            : url.href.replace(url.hostname, `www.${url.hostname}`),\r\n    );\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"rxjs\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"rxjs/operators\");","import { fromEvent } from 'rxjs';\r\nimport { filter, map, take } from 'rxjs/operators';\r\n\r\nimport { parseUrl } from '../url';\r\n\r\nimport IframeEvent from './iframe-event';\r\nimport isIframeEvent from './is-iframe-event';\r\n\r\nexport interface IframeEventPostOptions<\r\n    TSuccessEvent extends IframeEvent,\r\n    TErrorEvent extends IframeEvent,\r\n> {\r\n    errorType?: TErrorEvent['type'];\r\n    successType?: TSuccessEvent['type'];\r\n}\r\n\r\nexport default class IframeEventPoster<TEvent> {\r\n    private _targetOrigin: string;\r\n\r\n    constructor(targetOrigin: string, private _targetWindow?: Window) {\r\n        this._targetOrigin = targetOrigin === '*' ? '*' : parseUrl(targetOrigin).origin;\r\n    }\r\n\r\n    post(event: TEvent): void;\r\n    post<\r\n        TSuccessEvent extends IframeEvent = IframeEvent,\r\n        TErrorEvent extends IframeEvent = IframeEvent,\r\n    >(\r\n        event: TEvent,\r\n        options: IframeEventPostOptions<TSuccessEvent, TErrorEvent>,\r\n    ): Promise<TSuccessEvent>;\r\n    post<\r\n        TSuccessEvent extends IframeEvent = IframeEvent,\r\n        TErrorEvent extends IframeEvent = IframeEvent,\r\n    >(\r\n        event: TEvent,\r\n        options?: IframeEventPostOptions<TSuccessEvent, TErrorEvent>,\r\n    ): Promise<TSuccessEvent> | void {\r\n        const targetWindow = this._targetWindow;\r\n\r\n        if (window === targetWindow) {\r\n            return;\r\n        }\r\n\r\n        if (!targetWindow) {\r\n            throw new Error('Unable to post message because target window is not set.');\r\n        }\r\n\r\n        const result =\r\n            options &&\r\n            fromEvent<MessageEvent>(window, 'message')\r\n                .pipe(\r\n                    filter(\r\n                        (event) =>\r\n                            event.origin === this._targetOrigin &&\r\n                            isIframeEvent(event.data, event.data.type) &&\r\n                            [options.successType, options.errorType].indexOf(event.data.type) !==\r\n                                -1,\r\n                    ),\r\n                    map((event) => {\r\n                        if (options.errorType === event.data.type) {\r\n                            throw event.data;\r\n                        }\r\n\r\n                        return event.data;\r\n                    }),\r\n                    take(1),\r\n                )\r\n                .toPromise();\r\n\r\n        targetWindow.postMessage(event, this._targetOrigin);\r\n\r\n        return result;\r\n    }\r\n\r\n    setTarget(window: Window) {\r\n        this._targetWindow = window;\r\n    }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"local-storage-fallback\");","import { default as storage } from 'local-storage-fallback';\r\n\r\nexport default class BrowserStorage {\r\n    constructor(private _namespace: string) {}\r\n\r\n    getItem<TValue = any>(key: string): TValue | null {\r\n        const rawValue = storage.getItem(this.withNamespace(key));\r\n\r\n        if (rawValue === null) {\r\n            return null;\r\n        }\r\n\r\n        try {\r\n            return JSON.parse(rawValue);\r\n        } catch (error) {\r\n            // Clean up invalid values\r\n            this.removeItem(this.withNamespace(key));\r\n\r\n            return null;\r\n        }\r\n    }\r\n\r\n    getItemOnce<TValue = any>(key: string): TValue | null {\r\n        const value = this.getItem(key);\r\n\r\n        this.removeItem(key);\r\n\r\n        return value;\r\n    }\r\n\r\n    setItem<TValue = any>(key: string, value: TValue): void {\r\n        return storage.setItem(this.withNamespace(key), JSON.stringify(value));\r\n    }\r\n\r\n    removeItem(key: string): void {\r\n        return storage.removeItem(this.withNamespace(key));\r\n    }\r\n\r\n    private withNamespace(key: string): string {\r\n        return `${this._namespace}.${key}`;\r\n    }\r\n}\r\n","import EmbeddedCheckoutError from './embedded-checkout-error';\r\nimport { EmbeddedContentOptions } from './iframe-content';\r\n\r\nexport enum EmbeddedCheckoutEventType {\r\n    CheckoutComplete = 'CHECKOUT_COMPLETE',\r\n    CheckoutError = 'CHECKOUT_ERROR',\r\n    CheckoutLoaded = 'CHECKOUT_LOADED',\r\n    FrameError = 'FRAME_ERROR',\r\n    FrameLoaded = 'FRAME_LOADED',\r\n    SignedOut = 'SIGNED_OUT',\r\n}\r\n\r\nexport interface EmbeddedCheckoutEventMap {\r\n    [EmbeddedCheckoutEventType.CheckoutComplete]: EmbeddedCheckoutCompleteEvent;\r\n    [EmbeddedCheckoutEventType.CheckoutError]: EmbeddedCheckoutErrorEvent;\r\n    [EmbeddedCheckoutEventType.CheckoutLoaded]: EmbeddedCheckoutLoadedEvent;\r\n    [EmbeddedCheckoutEventType.FrameError]: EmbeddedCheckoutFrameErrorEvent;\r\n    [EmbeddedCheckoutEventType.FrameLoaded]: EmbeddedCheckoutFrameLoadedEvent;\r\n    [EmbeddedCheckoutEventType.SignedOut]: EmbeddedCheckoutSignedOutEvent;\r\n}\r\n\r\nexport type EmbeddedCheckoutEvent =\r\n    | EmbeddedCheckoutCompleteEvent\r\n    | EmbeddedCheckoutErrorEvent\r\n    | EmbeddedCheckoutFrameErrorEvent\r\n    | EmbeddedCheckoutFrameLoadedEvent\r\n    | EmbeddedCheckoutLoadedEvent\r\n    | EmbeddedCheckoutSignedOutEvent;\r\n\r\nexport interface EmbeddedCheckoutCompleteEvent {\r\n    type: EmbeddedCheckoutEventType.CheckoutComplete;\r\n}\r\n\r\nexport interface EmbeddedCheckoutErrorEvent {\r\n    type: EmbeddedCheckoutEventType.CheckoutError;\r\n    payload: EmbeddedCheckoutError;\r\n}\r\n\r\nexport interface EmbeddedCheckoutLoadedEvent {\r\n    type: EmbeddedCheckoutEventType.CheckoutLoaded;\r\n}\r\n\r\nexport interface EmbeddedCheckoutFrameErrorEvent {\r\n    type: EmbeddedCheckoutEventType.FrameError;\r\n    payload: EmbeddedCheckoutError;\r\n}\r\n\r\nexport interface EmbeddedCheckoutFrameLoadedEvent {\r\n    type: EmbeddedCheckoutEventType.FrameLoaded;\r\n    payload?: EmbeddedContentOptions;\r\n}\r\n\r\nexport interface EmbeddedCheckoutSignedOutEvent {\r\n    type: EmbeddedCheckoutEventType.SignedOut;\r\n}\r\n","import { Response } from '@bigcommerce/request-sender';\r\n\r\nimport StandardError from './standard-error';\r\n\r\nconst DEFAULT_RESPONSE = {\r\n    body: {},\r\n    headers: {},\r\n    status: 0,\r\n};\r\n\r\n/**\r\n * Throw this error if we are unable to make a request to the server. It wraps\r\n * any server response into a JS error object.\r\n */\r\nexport default class RequestError<TBody = any> extends StandardError {\r\n    body: TBody | {};\r\n    headers: { [key: string]: any };\r\n    errors: Array<{ code: string; message?: string }>;\r\n    status: number;\r\n\r\n    constructor(\r\n        response?: Response<TBody | {}>,\r\n        {\r\n            message,\r\n            errors,\r\n        }: {\r\n            message?: string;\r\n            errors?: Array<{ code: string; message?: string }>;\r\n        } = {},\r\n    ) {\r\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\r\n\r\n        super(message || 'An unexpected error has occurred.');\r\n\r\n        this.name = 'RequestError';\r\n        this.type = 'request';\r\n        this.body = body;\r\n        this.headers = headers;\r\n        this.status = status;\r\n        this.errors = errors || [];\r\n    }\r\n}\r\n","import { Response } from '@bigcommerce/request-sender';\r\n\r\nimport { InternalErrorResponseBody } from '@bigcommerce/checkout-sdk/payment-integration-api';\r\n\r\nimport { RequestError } from '../../common/error/errors';\r\n\r\n/**\r\n * Throw this error we are not able to sign in a shopper because the provided\r\n * login token is invalid.\r\n */\r\nexport default class InvalidLoginTokenError extends RequestError {\r\n    constructor(response: Response<InternalErrorResponseBody>) {\r\n        super(response, { message: response.body.title });\r\n\r\n        this.name = 'InvalidLoginTokenError';\r\n        this.type = 'invalid_login_token';\r\n    }\r\n}\r\n","import { StandardError } from '../../common/error/errors';\r\n\r\nexport enum NotEmbeddableErrorType {\r\n    MissingContainer = 'missing_container',\r\n    MissingContent = 'missing_content',\r\n    UnknownError = 'unknown_error',\r\n}\r\n\r\n/**\r\n * Throw this error if we are not able to embed the checkout form as an iframe.\r\n * This can be due to the fact that the provided container ID is invalid, or the\r\n * checkout form fails to load inside the iframe. It can also be due to an\r\n * unknown reason.\r\n */\r\nexport default class NotEmbeddableError extends StandardError {\r\n    constructor(\r\n        message?: string,\r\n        public subtype: NotEmbeddableErrorType = NotEmbeddableErrorType.UnknownError,\r\n    ) {\r\n        super(message || 'Unable to embed the checkout form.');\r\n\r\n        this.name = 'NotEmbeddableError';\r\n        this.type = 'not_embeddable';\r\n    }\r\n}\r\n","import EmbeddedCheckoutStyles from '../embedded-checkout-styles';\r\n\r\nexport enum EmbeddedContentEventType {\r\n    StyleConfigured = 'STYLE_CONFIGURED',\r\n}\r\n\r\nexport interface EmbeddedContentEventMap {\r\n    [EmbeddedContentEventType.StyleConfigured]: EmbeddedContentStyleConfiguredEvent;\r\n}\r\n\r\nexport type EmbeddedContentEvent = EmbeddedContentStyleConfiguredEvent;\r\n\r\nexport interface EmbeddedContentStyleConfiguredEvent {\r\n    type: EmbeddedContentEventType.StyleConfigured;\r\n    payload: EmbeddedCheckoutStyles;\r\n}\r\n","import { RequestSender } from '@bigcommerce/request-sender';\r\n\r\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\r\n\r\nimport { IFrameComponent, IframeEventListener, IframeEventPoster } from '../common/iframe';\r\nimport { BrowserStorage } from '../common/storage';\r\nimport { parseUrl } from '../common/url';\r\nimport { bindDecorator as bind } from '../common/utility';\r\n\r\nimport EmbeddedCheckoutError from './embedded-checkout-error';\r\nimport { EmbeddedCheckoutEventMap, EmbeddedCheckoutEventType } from './embedded-checkout-events';\r\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\r\nimport { InvalidLoginTokenError, NotEmbeddableError, NotEmbeddableErrorType } from './errors';\r\nimport { EmbeddedContentEvent, EmbeddedContentEventType } from './iframe-content';\r\nimport ResizableIframeCreator from './resizable-iframe-creator';\r\n\r\nexport const ALLOW_COOKIE_ATTEMPT_INTERVAL = 10 * 60 * 1000;\r\nexport const IS_COOKIE_ALLOWED_KEY = 'isCookieAllowed';\r\nexport const LAST_ALLOW_COOKIE_ATTEMPT_KEY = 'lastAllowCookieAttempt';\r\n\r\n@bind\r\nexport default class EmbeddedCheckout {\r\n    private _iframe?: IFrameComponent;\r\n    private _isAttached: boolean;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    constructor(\r\n        private _iframeCreator: ResizableIframeCreator,\r\n        private _messageListener: IframeEventListener<EmbeddedCheckoutEventMap>,\r\n        private _messagePoster: IframeEventPoster<EmbeddedContentEvent>,\r\n        private _loadingIndicator: LoadingIndicator,\r\n        private _requestSender: RequestSender,\r\n        private _storage: BrowserStorage,\r\n        private _location: Location,\r\n        private _options: EmbeddedCheckoutOptions,\r\n    ) {\r\n        this._isAttached = false;\r\n\r\n        if (this._options.onComplete) {\r\n            this._messageListener.addListener(\r\n                EmbeddedCheckoutEventType.CheckoutComplete,\r\n                this._options.onComplete,\r\n            );\r\n        }\r\n\r\n        if (this._options.onError) {\r\n            this._messageListener.addListener(\r\n                EmbeddedCheckoutEventType.CheckoutError,\r\n                this._options.onError,\r\n            );\r\n        }\r\n\r\n        if (this._options.onLoad) {\r\n            this._messageListener.addListener(\r\n                EmbeddedCheckoutEventType.CheckoutLoaded,\r\n                this._options.onLoad,\r\n            );\r\n        }\r\n\r\n        if (this._options.onFrameLoad) {\r\n            this._messageListener.addListener(\r\n                EmbeddedCheckoutEventType.FrameLoaded,\r\n                this._options.onFrameLoad,\r\n            );\r\n        }\r\n\r\n        if (this._options.onSignOut) {\r\n            this._messageListener.addListener(\r\n                EmbeddedCheckoutEventType.SignedOut,\r\n                this._options.onSignOut,\r\n            );\r\n        }\r\n\r\n        this._messageListener.addListener(EmbeddedCheckoutEventType.FrameLoaded, () =>\r\n            this._configureStyles(),\r\n        );\r\n    }\r\n\r\n    attach(): Promise<this> {\r\n        if (this._isAttached) {\r\n            return Promise.resolve(this);\r\n        }\r\n\r\n        this._isAttached = true;\r\n        this._messageListener.listen();\r\n        this._loadingIndicator.show(this._options.containerId);\r\n\r\n        return this._allowCookie()\r\n            .then(() => this._attemptLogin())\r\n            .then((url) => this._iframeCreator.createFrame(url, this._options.containerId))\r\n            .then((iframe) => {\r\n                this._iframe = iframe;\r\n\r\n                this._configureStyles();\r\n                this._loadingIndicator.hide();\r\n            })\r\n            .catch((error) => {\r\n                this._isAttached = false;\r\n\r\n                return this._retryAllowCookie(error).catch(() => {\r\n                    this._messageListener.trigger({\r\n                        type: EmbeddedCheckoutEventType.FrameError,\r\n                        payload: error,\r\n                    });\r\n\r\n                    this._loadingIndicator.hide();\r\n\r\n                    throw error;\r\n                });\r\n            })\r\n            .then(() => this);\r\n    }\r\n\r\n    detach(): void {\r\n        if (!this._isAttached) {\r\n            return;\r\n        }\r\n\r\n        this._isAttached = false;\r\n        this._messageListener.stopListen();\r\n\r\n        if (this._iframe && this._iframe.parentNode) {\r\n            this._iframe.parentNode.removeChild(this._iframe);\r\n            this._iframe.iFrameResizer.close();\r\n        }\r\n    }\r\n\r\n    private _configureStyles(): void {\r\n        if (!this._iframe || !this._iframe.contentWindow || !this._options.styles) {\r\n            return;\r\n        }\r\n\r\n        this._messagePoster.setTarget(this._iframe.contentWindow);\r\n\r\n        this._messagePoster.post({\r\n            type: EmbeddedContentEventType.StyleConfigured,\r\n            payload: this._options.styles,\r\n        });\r\n    }\r\n\r\n    private _attemptLogin(): Promise<string> {\r\n        if (!/^\\/login\\/token/.test(parseUrl(this._options.url).pathname)) {\r\n            return Promise.resolve(this._options.url);\r\n        }\r\n\r\n        return this._requestSender\r\n            .post<{ redirectUrl: string }>(this._options.url)\r\n            .then(({ body: { redirectUrl } }) => redirectUrl)\r\n            .catch((response) => Promise.reject(new InvalidLoginTokenError(response)));\r\n    }\r\n\r\n    /**\r\n     * This workaround is required for certain browsers (namely Safari) that\r\n     * prevent session cookies to be set for a third party website unless the\r\n     * user has recently visited such website. Therefore, before we attempt to\r\n     * login or set an active cart in the session, we need to first redirect the\r\n     * user to the domain of Embedded Checkout.\r\n     */\r\n    private _allowCookie(): Promise<void> {\r\n        if (this._storage.getItem(IS_COOKIE_ALLOWED_KEY)) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        this._storage.setItem(IS_COOKIE_ALLOWED_KEY, true);\r\n\r\n        // It could be possible that the flag is set to true but the browser has\r\n        // already removed the permission to store third-party cookies. In that\r\n        // case, we should try to redirect the user again. But we only want to\r\n        // do it once within a fixed interval. This is to avoid getting into a\r\n        // redirect loop if the shopper actually doesn't have a valid card\r\n        // session.\r\n        this._storage.setItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY, Date.now());\r\n\r\n        const { origin } = parseUrl(this._options.url);\r\n        const redirectUrl = `${origin}/embedded-checkout/allow-cookie?returnUrl=${encodeURIComponent(\r\n            this._location.href,\r\n        )}`;\r\n\r\n        document.body.style.visibility = 'hidden';\r\n        this._location.replace(redirectUrl);\r\n\r\n        return new Promise<never>(() => {});\r\n    }\r\n\r\n    private _retryAllowCookie(error: EmbeddedCheckoutError): Promise<void> {\r\n        const lastAttempt = Number(this._storage.getItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY));\r\n        const canRetry =\r\n            (!lastAttempt || Date.now() - lastAttempt > ALLOW_COOKIE_ATTEMPT_INTERVAL) &&\r\n            error instanceof NotEmbeddableError &&\r\n            error.subtype === NotEmbeddableErrorType.MissingContent;\r\n\r\n        if (!canRetry) {\r\n            return Promise.reject();\r\n        }\r\n\r\n        this._storage.removeItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY);\r\n        this._storage.removeItem(IS_COOKIE_ALLOWED_KEY);\r\n\r\n        return this._allowCookie();\r\n    }\r\n}\r\n","import { IFrameComponent, iframeResizer, isIframeEvent } from '../common/iframe';\r\nimport { parseUrl } from '../common/url';\r\n\r\nimport { EmbeddedCheckoutEventType } from './embedded-checkout-events';\r\nimport { NotEmbeddableError, NotEmbeddableErrorType } from './errors';\r\n\r\nexport default class ResizableIframeCreator {\r\n    constructor(private _options?: { timeout: number }) {}\r\n\r\n    createFrame(src: string, containerId: string): Promise<IFrameComponent> {\r\n        const container = document.getElementById(containerId);\r\n        const { timeout = 60000 } = this._options || {};\r\n\r\n        if (!container) {\r\n            throw new NotEmbeddableError(\r\n                'Unable to embed the iframe because the container element could not be found.',\r\n                NotEmbeddableErrorType.MissingContainer,\r\n            );\r\n        }\r\n\r\n        const iframe = document.createElement('iframe');\r\n\r\n        iframe.src = src;\r\n        iframe.style.border = 'none';\r\n        iframe.style.display = 'none';\r\n        iframe.style.width = '100%';\r\n        iframe.allowPaymentRequest = true;\r\n\r\n        container.appendChild(iframe);\r\n\r\n        return this._toResizableFrame(iframe, timeout).catch((error) => {\r\n            container.removeChild(iframe);\r\n\r\n            throw error;\r\n        });\r\n    }\r\n\r\n    private _toResizableFrame(\r\n        iframe: HTMLIFrameElement,\r\n        timeoutInterval: number,\r\n    ): Promise<IFrameComponent> {\r\n        // Can't simply listen to `load` event because it always gets triggered even if there's an error.\r\n        // Instead, listen to the `load` inside the iframe and let the parent frame know when it happens.\r\n        return new Promise((resolve, reject) => {\r\n            const timeout = window.setTimeout(() => {\r\n                reject(\r\n                    new NotEmbeddableError(\r\n                        'Unable to embed the iframe because the content could not be loaded.',\r\n                    ),\r\n                );\r\n            }, timeoutInterval);\r\n\r\n            const handleMessage = (event: MessageEvent) => {\r\n                if (event.origin !== parseUrl(iframe.src).origin) {\r\n                    return;\r\n                }\r\n\r\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameError)) {\r\n                    teardown();\r\n                    reject(\r\n                        new NotEmbeddableError(\r\n                            event.data.payload.message,\r\n                            NotEmbeddableErrorType.MissingContent,\r\n                        ),\r\n                    );\r\n                }\r\n\r\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameLoaded)) {\r\n                    iframe.style.display = '';\r\n\r\n                    const contentId = event.data.payload && event.data.payload.contentId;\r\n                    const iframes = iframeResizer(\r\n                        {\r\n                            scrolling: false,\r\n                            sizeWidth: false,\r\n                            heightCalculationMethod: contentId ? 'taggedElement' : 'lowestElement',\r\n                        },\r\n                        iframe,\r\n                    );\r\n\r\n                    teardown();\r\n                    resolve(iframes[iframes.length - 1]);\r\n                }\r\n            };\r\n\r\n            const teardown = () => {\r\n                window.removeEventListener('message', handleMessage);\r\n                window.clearTimeout(timeout);\r\n            };\r\n\r\n            window.addEventListener('message', handleMessage);\r\n        });\r\n    }\r\n}\r\n","import { IFrameComponent, IFrameOptions } from 'iframe-resizer';\r\n\r\nexport {\r\n    HeightCalculationMethod,\r\n    IFrameComponent,\r\n    IFrameMessageData,\r\n    IFrameObject,\r\n    IFrameOptions,\r\n    IFramePage,\r\n    IFramePageOptions,\r\n    IFrameResizedData,\r\n    IFrameScrollData,\r\n    PageInfo,\r\n    WidthCalculationMethod,\r\n} from 'iframe-resizer';\r\n\r\n// The reason why we are wrapping the original `iframeResizer` function imported\r\n// from the package is because the package sets up event listeners (window\r\n// resize etc...) as soon as the package is imported. Therefore, to defer the\r\n// side effect from happening until the function is actually being used, we are\r\n// importing the package inside this function. To minimise the chance of\r\n// importing the original package inadvertently, we are also re-exporting all of\r\n// its public interfaces. The re-exports do not cause any side effect because\r\n// they are plain TypeScript interfaces; meaning they are only used for type\r\n// checks rather than for code output.\r\nexport function iframeResizer(\r\n    options: IFrameOptions,\r\n    target: string | HTMLElement,\r\n): IFrameComponent[] {\r\n    /* eslint-disable @typescript-eslint/no-var-requires */\r\n    const { iframeResizer: originalIframeResizer } = require('iframe-resizer');\r\n\r\n    return originalIframeResizer(options, target);\r\n}\r\n\r\n// We also need to wrap the original `iframeResizer.contentWindow` because\r\n// similarly the package sets up event listeners as soon as the package gets\r\n// imported. Another reason is that if it is imported at the top level using a\r\n// regular import statement, it will be stripped out by Webpack as it is\r\n// considered as \"unused\", unless we explicitly mark it as a package that\r\n// produces side effects.\r\nexport function setupContentWindowForIframeResizer(): void {\r\n    require('iframe-resizer/js/iframeResizer.contentWindow');\r\n}\r\n","import { createRequestSender } from '@bigcommerce/request-sender';\r\n\r\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\r\n\r\nimport { IframeEventListener, IframeEventPoster } from '../common/iframe';\r\nimport { BrowserStorage } from '../common/storage';\r\nimport { parseUrl } from '../common/url';\r\n\r\nimport EmbeddedCheckout from './embedded-checkout';\r\nimport { EmbeddedCheckoutEventMap } from './embedded-checkout-events';\r\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\r\nimport { EmbeddedContentEvent } from './iframe-content';\r\nimport ResizableIframeCreator from './resizable-iframe-creator';\r\n\r\nconst STORAGE_PREFIX = 'BigCommerce.EmbeddedCheckout';\r\n\r\n/**\r\n * Embed the checkout form in an iframe.\r\n *\r\n * @remarks\r\n * Once the iframe is embedded, it will automatically resize according to the\r\n * size of the checkout form. It will also notify the parent window when certain\r\n * events have occurred. i.e.: when the form is loaded and ready to be used.\r\n *\r\n * ```js\r\n * embedCheckout({\r\n *     url: 'https://checkout/url',\r\n *     containerId: 'container-id',\r\n * });\r\n * ```\r\n *\r\n * @param options - Options for embedding the checkout form.\r\n * @returns A promise that resolves to an instance of `EmbeddedCheckout`.\r\n */\r\nexport default function embedCheckout(options: EmbeddedCheckoutOptions): Promise<EmbeddedCheckout> {\r\n    const origin = parseUrl(options.url).origin;\r\n    const embeddedCheckout = new EmbeddedCheckout(\r\n        new ResizableIframeCreator(),\r\n        new IframeEventListener<EmbeddedCheckoutEventMap>(origin),\r\n        new IframeEventPoster<EmbeddedContentEvent>(origin),\r\n        new LoadingIndicator({ styles: options.styles && options.styles.loadingIndicator }),\r\n        createRequestSender(),\r\n        new BrowserStorage(STORAGE_PREFIX),\r\n        window.location,\r\n        options,\r\n    );\r\n\r\n    return embeddedCheckout.attach();\r\n}\r\n","import { EmbeddedCheckoutFrameLoadedEvent } from '../embedded-checkout-events';\r\n\r\nexport default function handleFrameLoadedEvent(message: EmbeddedCheckoutFrameLoadedEvent): void {\r\n    if (!message.payload || !message.payload.contentId) {\r\n        return;\r\n    }\r\n\r\n    const body = document.getElementById(message.payload.contentId);\r\n\r\n    if (!body || body.hasAttribute('data-iframe-height')) {\r\n        return;\r\n    }\r\n\r\n    body.setAttribute('data-iframe-height', '');\r\n}\r\n","export default interface CustomError extends Error {\r\n    message: string;\r\n    type: string;\r\n    subtype?: string;\r\n}\r\n\r\nexport function isCustomError(error: unknown): error is CustomError {\r\n    return typeof error === 'object' && error !== null && 'message' in error && 'type' in error;\r\n}\r\n","import { CustomError, isCustomError } from '../../common/error/errors';\r\nimport { IframeEventListener, IframeEventPoster } from '../../common/iframe';\r\nimport { bindDecorator as bind } from '../../common/utility';\r\nimport EmbeddedCheckoutError from '../embedded-checkout-error';\r\nimport {\r\n    EmbeddedCheckoutCompleteEvent,\r\n    EmbeddedCheckoutErrorEvent,\r\n    EmbeddedCheckoutEvent,\r\n    EmbeddedCheckoutEventMap,\r\n    EmbeddedCheckoutEventType,\r\n    EmbeddedCheckoutFrameErrorEvent,\r\n    EmbeddedCheckoutFrameLoadedEvent,\r\n    EmbeddedCheckoutLoadedEvent,\r\n    EmbeddedCheckoutSignedOutEvent,\r\n} from '../embedded-checkout-events';\r\nimport EmbeddedCheckoutStyles from '../embedded-checkout-styles';\r\n\r\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\r\nimport { EmbeddedContentEventMap, EmbeddedContentEventType } from './embedded-content-events';\r\nimport EmbeddedContentOptions from './embedded-content-options';\r\n\r\n@bind\r\nexport default class IframeEmbeddedCheckoutMessenger implements EmbeddedCheckoutMessenger {\r\n    /**\r\n     * @internal\r\n     */\r\n    constructor(\r\n        private _messageListener: IframeEventListener<EmbeddedContentEventMap>,\r\n        private _messagePoster: IframeEventPoster<EmbeddedCheckoutEvent>,\r\n        private _untargetedMessagePoster: IframeEventPoster<EmbeddedCheckoutEvent>,\r\n        private _messageHandlers: EventCallbacks<EmbeddedCheckoutEventMap> = {},\r\n    ) {\r\n        this._messageListener.listen();\r\n    }\r\n\r\n    postComplete(): void {\r\n        const message: EmbeddedCheckoutCompleteEvent = {\r\n            type: EmbeddedCheckoutEventType.CheckoutComplete,\r\n        };\r\n\r\n        this._postMessage(message);\r\n    }\r\n\r\n    postError(payload: Error | CustomError): void {\r\n        const message: EmbeddedCheckoutErrorEvent = {\r\n            type: EmbeddedCheckoutEventType.CheckoutError,\r\n            payload: this._transformError(payload),\r\n        };\r\n\r\n        this._postMessage(message);\r\n    }\r\n\r\n    postFrameError(payload: Error | CustomError): void {\r\n        const message: EmbeddedCheckoutFrameErrorEvent = {\r\n            type: EmbeddedCheckoutEventType.FrameError,\r\n            payload: this._transformError(payload),\r\n        };\r\n\r\n        // Ideally, all messages should be targeted at a specific origin.\r\n        // However, for `FrameError` message, we have to post it in an\r\n        // untargeted fashion. This is because the error could be caused by a\r\n        // missing cart. That makes it not possible to determine of site origin\r\n        // of the parent window. Nevertheless, we still want to notify the\r\n        // parent window about the error.\r\n        this._postMessage(message, { untargeted: true });\r\n    }\r\n\r\n    postFrameLoaded(payload?: EmbeddedContentOptions): void {\r\n        const message: EmbeddedCheckoutFrameLoadedEvent = {\r\n            type: EmbeddedCheckoutEventType.FrameLoaded,\r\n            payload,\r\n        };\r\n\r\n        this._postMessage(message);\r\n    }\r\n\r\n    postLoaded(): void {\r\n        const message: EmbeddedCheckoutLoadedEvent = {\r\n            type: EmbeddedCheckoutEventType.CheckoutLoaded,\r\n        };\r\n\r\n        this._postMessage(message);\r\n    }\r\n\r\n    postSignedOut(): void {\r\n        const message: EmbeddedCheckoutSignedOutEvent = {\r\n            type: EmbeddedCheckoutEventType.SignedOut,\r\n        };\r\n\r\n        this._postMessage(message);\r\n    }\r\n\r\n    receiveStyles(handler: (styles: EmbeddedCheckoutStyles) => void): void {\r\n        this._messageListener.addListener(\r\n            EmbeddedContentEventType.StyleConfigured,\r\n            ({ payload }) => {\r\n                handler(payload);\r\n            },\r\n        );\r\n    }\r\n\r\n    private _postMessage(message: EmbeddedCheckoutEvent, options?: { untargeted?: boolean }): void {\r\n        this._notifyMessageHandlers(message);\r\n\r\n        if (options && options.untargeted) {\r\n            return this._untargetedMessagePoster.post(message);\r\n        }\r\n\r\n        this._messagePoster.post(message);\r\n    }\r\n\r\n    private _notifyMessageHandlers(message: EmbeddedCheckoutEvent): void {\r\n        Object.keys(this._messageHandlers).forEach((key) => {\r\n            if (message.type !== key) {\r\n                return;\r\n            }\r\n\r\n            const handler = this._messageHandlers[key];\r\n\r\n            if (handler) {\r\n                (handler as (event: EmbeddedCheckoutEvent) => void).call(null, message);\r\n            }\r\n        });\r\n    }\r\n\r\n    private _transformError(error: Error | CustomError): EmbeddedCheckoutError {\r\n        return {\r\n            message: error.message,\r\n            type: isCustomError(error) ? error.type : undefined,\r\n            subtype: isCustomError(error) ? error.subtype : undefined,\r\n        };\r\n    }\r\n}\r\n\r\nexport type EventCallbacks<TEventMap> = {\r\n    [key in keyof TEventMap]?: (event: TEventMap[key]) => void;\r\n};\r\n","import { bindDecorator as bind } from '../../common/utility';\r\n\r\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\r\n\r\n@bind\r\nexport default class NoopEmbeddedCheckoutMessenger implements EmbeddedCheckoutMessenger {\r\n    postComplete(): void {}\r\n\r\n    postError(): void {}\r\n\r\n    postFrameError(): void {}\r\n\r\n    postFrameLoaded(): void {}\r\n\r\n    postLoaded(): void {}\r\n\r\n    postSignedOut(): void {}\r\n\r\n    receiveStyles(): void {}\r\n}\r\n","import {\r\n    IframeEventListener,\r\n    IframeEventPoster,\r\n    setupContentWindowForIframeResizer,\r\n} from '../../common/iframe';\r\nimport { EmbeddedCheckoutEvent, EmbeddedCheckoutEventType } from '../embedded-checkout-events';\r\n\r\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\r\nimport EmbeddedCheckoutMessengerOptions from './embedded-checkout-messenger-options';\r\nimport { EmbeddedContentEventMap } from './embedded-content-events';\r\nimport handleFrameLoadedEvent from './handle-frame-loaded-event';\r\nimport IframeEmbeddedCheckoutMessenger from './iframe-embedded-checkout-messenger';\r\nimport NoopEmbeddedCheckoutMessenger from './noop-embedded-checkout-messenger';\r\n\r\n/**\r\n * Create an instance of `EmbeddedCheckoutMessenger`.\r\n *\r\n * @remarks\r\n * The object is responsible for posting messages to the parent window from the\r\n * iframe when certain events have occurred. For example, when the checkout\r\n * form is first loaded, you should notify the parent window about it.\r\n *\r\n * The iframe can only be embedded in domains that are allowed by the store.\r\n *\r\n * ```ts\r\n * const messenger = createEmbeddedCheckoutMessenger({\r\n *     parentOrigin: 'https://some/website',\r\n * });\r\n *\r\n * messenger.postFrameLoaded();\r\n * ```\r\n *\r\n * @alpha\r\n * Please note that this feature is currently in an early stage of development.\r\n * Therefore the API is unstable and not ready for public consumption.\r\n *\r\n * @param options - Options for creating `EmbeddedCheckoutMessenger`\r\n * @returns - An instance of `EmbeddedCheckoutMessenger`\r\n */\r\nexport default function createEmbeddedCheckoutMessenger(\r\n    options: EmbeddedCheckoutMessengerOptions,\r\n): EmbeddedCheckoutMessenger {\r\n    setupContentWindowForIframeResizer();\r\n\r\n    const parentWindow = options.parentWindow || window.parent;\r\n\r\n    // Return a No-op messenger if it is not called inside an iframe\r\n    if (window === parentWindow) {\r\n        return new NoopEmbeddedCheckoutMessenger();\r\n    }\r\n\r\n    return new IframeEmbeddedCheckoutMessenger(\r\n        new IframeEventListener<EmbeddedContentEventMap>(options.parentOrigin),\r\n        new IframeEventPoster<EmbeddedCheckoutEvent>(options.parentOrigin, parentWindow),\r\n        new IframeEventPoster<EmbeddedCheckoutEvent>('*', parentWindow),\r\n        { [EmbeddedCheckoutEventType.FrameLoaded]: handleFrameLoadedEvent },\r\n    );\r\n}\r\n"],"names":["module","exports","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","DEFAULT_STYLES","size","color","backgroundColor","ROTATION_ANIMATION","options","this","styles","defineAnimation","container","buildContainer","indicator","buildIndicator","appendChild","show","parentId","document","getElementById","Error","style","visibility","opacity","hide","handleTransitionEnd","removeEventListener","addEventListener","createElement","display","bottom","left","height","width","position","right","top","transition","borderRadius","border","borderColor","margin","transform","transformStyle","animation","id","head","sheet","CSSStyleSheet","insertRule","message","object","name","type","setPrototypeOf","__proto__","captureStackTrace","stack","parseUrl","url","test","anchor","href","port","indexOf","hostname","hash","origin","protocol","pathname","search","target","descriptor","bindMethodDecorator","decoratedTarget","getOwnPropertyNames","forEach","getOwnPropertyDescriptor","bindClassDecorator","_","method","boundMethod","bind","set","isIframeEvent","sourceOrigin","_sourceOrigins","replace","_isListening","_listeners","listen","window","_handleMessage","stopListen","addListener","listener","listeners","push","removeListener","index","splice","trigger","event","data","targetOrigin","_targetWindow","_targetOrigin","post","targetWindow","result","fromEvent","pipe","filter","successType","errorType","map","take","toPromise","postMessage","setTarget","_namespace","getItem","rawValue","withNamespace","JSON","parse","error","removeItem","getItemOnce","setItem","stringify","EmbeddedCheckoutEventType","DEFAULT_RESPONSE","body","headers","status","response","title","errors","NotEmbeddableErrorType","subtype","UnknownError","EmbeddedContentEventType","IS_COOKIE_ALLOWED_KEY","LAST_ALLOW_COOKIE_ATTEMPT_KEY","_iframeCreator","_messageListener","_messagePoster","_loadingIndicator","_requestSender","_storage","_location","_options","_isAttached","onComplete","CheckoutComplete","onError","CheckoutError","onLoad","CheckoutLoaded","onFrameLoad","FrameLoaded","onSignOut","SignedOut","_configureStyles","attach","Promise","resolve","containerId","_allowCookie","then","_attemptLogin","createFrame","iframe","_iframe","catch","_retryAllowCookie","FrameError","payload","detach","parentNode","removeChild","iFrameResizer","close","contentWindow","StyleConfigured","reject","Date","now","redirectUrl","encodeURIComponent","lastAttempt","Number","MissingContent","EmbeddedCheckout","src","timeout","MissingContainer","allowPaymentRequest","_toResizableFrame","timeoutInterval","setTimeout","handleMessage","teardown","iframes","scrolling","sizeWidth","heightCalculationMethod","contentId","originalIframeResizer","length","clearTimeout","STORAGE_PREFIX","embedCheckout","loadingIndicator","createRequestSender","location","handleFrameLoadedEvent","hasAttribute","setAttribute","isCustomError","_untargetedMessagePoster","_messageHandlers","postComplete","_postMessage","postError","_transformError","postFrameError","untargeted","postFrameLoaded","postLoaded","postSignedOut","receiveStyles","handler","_notifyMessageHandlers","keys","IframeEmbeddedCheckoutMessenger","NoopEmbeddedCheckoutMessenger","createEmbeddedCheckoutMessenger","parentWindow","parent","parentOrigin"],"sourceRoot":""}